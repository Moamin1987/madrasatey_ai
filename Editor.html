function generate() {
  let grade = document.getElementById("grade").value;
  let term = document.getElementById("term").value;
  let subject = document.getElementById("subject").value;
  let lessonName = document.getElementById("lessonName").value.trim();
  let fileName = document.getElementById("fileName").value.trim();

  if (!lessonName || !fileName) {
    alert("من فضلك اكتب اسم الدرس واسم الملف!");
    return;
  }

  // تحويل اسم الملف إلى صيغة آمنة للروابط
  let safeFileName = encodeURIComponent(fileName);

  let rawUrl = `https://raw.githubusercontent.com/${user}/${repo}/${branch}/lessons/${grade}/${term}/${subject}/${safeFileName}`;

  let lessonData = `
{
  "id": "${fileName.split('.')[0]}",
  "title": "${lessonName}",
  "type": "pdf",
  "url": "${rawUrl}"
},`;

  document.getElementById("output").value += lessonData + "\n";
}
